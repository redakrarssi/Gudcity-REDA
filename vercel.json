{
  "version": 2,
  "functions": {
    "api/auth/login.ts": {
      "memory": 1024,
      "maxDuration": 30
    },
    "api/auth/register.ts": {
      "memory": 1024,
      "maxDuration": 30
    },
    "api/auth/generate-tokens.ts": {
      "memory": 512,
      "maxDuration": 10
    },
    "api/db/initialize.ts": {
      "memory": 1024,
      "maxDuration": 60
    },
    "api/users/by-email.ts": {
      "memory": 512,
      "maxDuration": 15
    },
    "api/users/[id].ts": {
      "memory": 512,
      "maxDuration": 15
    },
    "api/admin/dashboard-stats.ts": {
      "memory": 1024,
      "maxDuration": 30
    },
    "api/business/[businessId]/[[...segments]].ts": {
      "memory": 1024,
      "maxDuration": 30
    },
    "api/analytics/[[...segments]].ts": {
      "memory": 1024,
      "maxDuration": 30
    },
    "api/[[...segments]].ts": {
      "memory": 1024,
      "maxDuration": 30
    },
    "api/v1/[[...path]].ts": {
      "memory": 1024,
      "maxDuration": 30
    }
  },
  "rewrites": [
    {
      "source": "/api/security/audit",
      "destination": "/api/v1/security/audit"
    },
    {
      "source": "/api/loyalty/cards/customer/:id",
      "destination": "/api/v1/loyalty/cards/customer/:id"
    },
    {
      "source": "/api/customers/:id/programs",
      "destination": "/api/v1/customers/:id/programs"
    },
    {
      "source": "/api/notifications",
      "destination": "/api/v1/notifications"
    },
    {
      "source": "/api/promotions",
      "destination": "/api/v1/promotions"
    },
    {
      "source": "/((?!api/).*)",
      "destination": "/index.html"
    }
  ],
  "headers": [
    {
      "source": "/api/(.*)",
      "headers": [
        { "key": "Cache-Control", "value": "no-store" },
        { "key": "X-Robots-Tag", "value": "noindex" }
      ]
    },
    {
      "source": "/:file",
      "headers": [
        { "key": "Cache-Control", "value": "public, max-age=31536000, immutable" }
      ]
    },
    {
      "source": "/(.*)",
      "headers": [
        { "key": "Strict-Transport-Security", "value": "max-age=31536000; includeSubDomains; preload" },
        { "key": "X-Content-Type-Options", "value": "nosniff" },
        { "key": "Referrer-Policy", "value": "strict-origin-when-cross-origin" },
        { "key": "X-Frame-Options", "value": "DENY" },
        { "key": "X-XSS-Protection", "value": "1; mode=block" },
        { "key": "Permissions-Policy", "value": "geolocation=(), microphone=(), camera=(self), payment=(), usb=(), magnetometer=(), gyroscope=()" },
        { "key": "Cross-Origin-Opener-Policy", "value": "same-origin" },
        { "key": "Cross-Origin-Embedder-Policy", "value": "require-corp" },
        { "key": "Cross-Origin-Resource-Policy", "value": "same-origin" },
        { 
          "key": "Content-Security-Policy", 
          "value": "default-src 'self'; script-src 'self' 'sha256-M3PL7NVfkaN2inr+elEMTxqNGkF6vi7V8kt4ke4uF6o=' 'sha256-P/VRGBm0RkFn61zbYTcQjQ5j7cFTwYTibjuDUesLRko=' 'sha256-8esrnIY3u5ewmj9gXlSTZioDMMYGDpy/zwIVQULOUL4=' 'sha256-xLF6AblLj3v7Z5KXrFWJhvLKrQLfk3MxwuMcNMINfdA='; style-src 'self' 'sha256-47DEQpj8HBSa+/TImW+5JCeuQeRkm5NMpJWZG3hSuFU=' 'sha256-Nqnn8clbgv+5l0PgxcTOldg8mkMKrFn4TvPL+rYUUGg=' 'sha256-13vrThxdyT64GcXoTNGVoRRoL0a7EGBmOJ+lemEWyws=' 'sha256-QZ52fjvWgIOIOPr+gRIJZ7KjzNeTBm50Z+z9dH4N1/8=' 'sha256-yOU6eaJ75xfag0gVFUvld5ipLRGUy94G17B1uL683EU=' 'sha256-OpTmykz0m3o5HoX53cykwPhUeU4OECxHQlKXpB0QJPQ=' 'sha256-SSIM0kI/u45y4gqkri9aH+la6wn2R+xtcBj3Lzh7qQo=' 'sha256-ZH/+PJIjvP1BctwYxclIuiMu1wItb0aasjpXYXOmU0Y=' 'sha256-58jqDtherY9NOM+ziRgSqQY0078tAZ+qtTBjMgbM9po=' 'sha256-7Ri/I+PfhgtpcL7hT4A0VJKI6g3pK0ZvIN09RQV4ZhI=' 'sha256-+XS14AbRVlq/0Daytmm0Uiy8mky/nmJvUAAqparKsDw=' https://fonts.googleapis.com; img-src 'self' data: https: blob:; connect-src 'self' https: wss:; font-src 'self' https://fonts.gstatic.com; object-src 'none'; media-src 'self' https:; frame-src 'none'; worker-src 'self' blob:; form-action 'self'; base-uri 'self'; manifest-src 'self'; frame-ancestors 'none'; upgrade-insecure-requests;" 
        }
      ]
    }
  ],
  "env": {
    "NODE_ENV": "production"
  }
}